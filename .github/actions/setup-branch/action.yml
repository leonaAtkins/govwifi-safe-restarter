name: "Setup branch"
description: "Create branch for Ruby updates and setup Ruby Eng"

runs:
  using: composite
  steps:
  - name: set branch name
    id: set-branch-name
    shell: bash
    run: |
      echo "COMMIT_BRANCH=update-to-ruby-${{ env.TARGET_RUBY_VERSION }}" >> $GITHUB_OUTPUT

  - name: Create or checkout branch
    shell: bash
    run: |
      if git ls-remote --exit-code --heads origin " ${{ steps.set-branch-name.COMMIT_BRANCH }}"; then
        git checkout ${{ steps.set-branch-name.outputs.COMMIT_BRANCH }}
      else
        git checkout -b ${{ steps.set-branch-name.outputs.COMMIT_BRANCH }}
      fi
